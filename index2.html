<<<<<<< HEAD
<!DOCTYPE html>
<html>
<head>
    <title>Flashcard C√° Nh√¢n</title>
    <style>
        /* --- Base Styles & Variables --- */
        :root {
            --bg-color: #f8f9fa; /* N·ªÅn s√°ng h∆°n m·ªôt ch√∫t */
            --text-color: #212529; /* Text t·ªëi h∆°n m·ªôt ch√∫t */
            --card-bg: #ffffff;
            --border-color: #dee2e6; /* Border nh·∫°t h∆°n */
            --input-bg: #ffffff;
            --input-text: #495057;
            --input-border: #ced4da;
            --input-focus-border: #86b7fe;
            --input-focus-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);

            --primary-btn-bg: #0d6efd;
            --primary-btn-hover-bg: #0b5ed7;
            --primary-btn-text: #ffffff;

            --secondary-btn-bg: #6c757d;
            --secondary-btn-hover-bg: #5c636a;
            --secondary-btn-text: #ffffff;

            --danger-btn-bg: #dc3545;
            --danger-btn-hover-bg: #bb2d3b;
            --danger-btn-text: #ffffff;

            --warning-btn-bg: #ffc107;
            --warning-btn-hover-bg: #ffca2c;
            --warning-btn-text: #000;

            --success-btn-bg: #198754;
            --success-btn-hover-bg: #157347;
            --success-btn-text: #ffffff;

            --shadow-sm: 0 .125rem .25rem rgba(0, 0, 0, .075);
            --shadow-md: 0 .5rem 1rem rgba(0, 0, 0, .15);

            --moon-color: #ffffff; /* Th√™m bi·∫øn m√†u m·∫∑t trƒÉng */
            --handle-dark-bg: transparent; /* N·ªÅn handle trong dark mode */
            --star-size-light: 2px;
            --star-size-dark: 4px; /* K√≠ch th∆∞·ªõc sao l·ªõn h∆°n trong dark mode */
            --star-shadow-dark: 0 0 5px rgba(255, 255, 255, 0.7); /* Shadow sao r√µ h∆°n */
        }

        .dark-mode {
            --bg-color: #212529;
            --text-color: #dee2e6;
            --card-bg: #343a40;
            --border-color: #495057;
            --input-bg: #343a40;
            --input-text: #dee2e6;
            --input-border: #6c757d;
            --input-focus-border: #5b99e4;
            --input-focus-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.35);

            --primary-btn-bg: #0d6efd;
            --primary-btn-hover-bg: #3b82f6;
            --secondary-btn-bg: #6c757d;
            --secondary-btn-hover-bg: #858c93;
            --danger-btn-bg: #dc3545;
            --danger-btn-hover-bg: #e45d6a;
            --warning-btn-bg: #ffc107;
            --warning-btn-hover-bg: #ffd041;
            --success-btn-bg: #198754;
            --success-btn-hover-bg: #20a768;
            --markmap-text-color: var(--text-color);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            max-width: 700px; /* TƒÉng chi·ªÅu r·ªông t·ªëi ƒëa m·ªôt ch√∫t */
            margin: 30px auto; /* TƒÉng margin tr√™n d∆∞·ªõi */
            padding: 20px; /* TƒÉng padding */
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            line-height: 1.6; /* C·∫£i thi·ªán kh·∫£ nƒÉng ƒë·ªçc */
        }

        h1 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--text-color);
        }

        /* --- Theme Toggle Switch --- */
        .theme-toggle {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 25px;
            gap: 10px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #87CEEB; /* M√†u tr·ªùi xanh ban ng√†y */
            transition: background-color .4s;
            overflow: hidden;
            background-color: #FFD700; /* M√†u v√†ng m·∫∑t tr·ªùi (light) */
        }

        /* Style cho n√∫t tr√≤n di chuy·ªÉn m·ªõi (.handle) */
        .slider .handle {
            position: absolute;
            content: "";
            height: 22px; /* K√≠ch th∆∞·ªõc n√∫t tr√≤n */
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: #FFD700; /* M√†u v√†ng m·∫∑t tr·ªùi (light) */
            box-shadow: 0 0 5px rgba(255, 215, 0, 0.7); /* H√†o quang nh·∫π */
            transition: transform .4s, background-color .4s, box-shadow .4s;
            border-radius: 50%; /* Bo tr√≤n n√∫t */
            z-index: 2; /* ƒê·∫£m b·∫£o handle tr√™n stars */
            display: flex; /* ƒê·ªÉ cƒÉn gi·ªØa icon b√™n trong */
            justify-content: center; /* CƒÉn ngang icon */
            align-items: center; /* CƒÉn d·ªçc icon */
            overflow: hidden; /* ·∫®n ph·∫ßn icon th·ª´a n·∫øu c·∫ßn */
            background-color: #FFD700; /* M√†u v√†ng m·∫∑t tr·ªùi (light) */
        }


        input:checked + .slider {
            background-color: #2c3e50; /* M√†u n·ªÅn tr·ªùi ƒë√™m */
        }

        /* Di chuy·ªÉn .handle khi checked */
        input:checked + .slider .handle {
            transform: translateX(30px); /* Kho·∫£ng c√°ch di chuy·ªÉn n√∫t tr√≤n */
            background-color: #f1c40f; /* M√†u v√†ng nh·∫°t h∆°n cho m·∫∑t trƒÉng (dark) */
            box-shadow: none; /* ·∫®n shadow */
        }

        /* Bo tr√≤n slider ngo√†i */
        .slider.round {
            border-radius: 30px;
        }

        /* --- Icons (B√™n trong .handle) --- */
        .handle .icon {
            position: absolute; /* V·∫´n l√† absolute ƒë·ªÉ c√≥ th·ªÉ ch·ªìng l√™n nhau */
            font-size: 16px;
            transition: opacity 0.4s ease; /* Ch·ªâ c·∫ßn transition opacity */
        }

        .handle .sun {
            opacity: 1; /* Hi·ªán ·ªü ch·∫ø ƒë·ªô s√°ng (m·∫∑c ƒë·ªãnh) */
            color: #f39c12;
            animation: spin 10s linear infinite; /* Gi·ªØ animation quay */
        }

        .handle .moon {
            opacity: 0;
            color: var(--moon-color);
        }

        /* Khi switch ƒë∆∞·ª£c check (dark mode) */
        input:checked + .slider .handle .sun {
            opacity: 0; /* ·∫®n m·∫∑t tr·ªùi */
            animation-play-state: paused; /* D·ª´ng quay m·∫∑t tr·ªùi */
        }

        input:checked + .slider .handle .moon {
            opacity: 1; /* Hi·ªán m·∫∑t trƒÉng */
        }

        /* --- Stars (Kh√¥ng ƒë·ªïi) --- */
        .slider .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.4s ease 0.2s;
            pointer-events: none;
            z-index: 0; /* N·∫±m d∆∞·ªõi c√πng */
        }

        .slider .star {
            position: absolute;
            width: var(--star-size-light); /* K√≠ch th∆∞·ªõc sao m·∫∑c ƒë·ªãnh (light) */
            height: var(--star-size-light);
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 0 3px white;
            animation: twinkle 1.5s infinite alternate ease-in-out;
            transition: width 0.4s ease, height 0.4s ease, box-shadow 0.4s ease; /* Th√™m transition */
        }
        .slider .star:nth-child(1) { top: 20%; left: 60%; animation-delay: 0.1s; }
        .slider .star:nth-child(2) { top: 40%; left: 80%; animation-delay: 0.5s; }
        .slider .star:nth-child(3) { top: 70%; left: 75%; animation-delay: 0.9s; }
        .slider .star:nth-child(4) { top: 50%; left: 90%; animation-delay: 0.3s; }

        input:checked + .slider .stars {
            width: var(--star-size-dark);
            height: var(--star-size-dark);
            box-shadow: var(--star-shadow-dark);
        }

        input:checked + .slider .stars {
            opacity: 1;
        }


        /* Keyframes cho animation (Kh√¥ng ƒë·ªïi) */
        @keyframes twinkle {
            from { opacity: 0.2; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        /* S·ª≠a l·∫°i keyframes spin cho ph√π h·ª£p khi icon kh√¥ng c·∫ßn translateY */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        /* --- End Theme Toggle Switch --- */



        /* Rounded sliders */
        .slider.round {
            border-radius: 26px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        /* --- Input Fields & Select --- */
        input[type="text"], select {
            display: block; /* Hi·ªÉn th·ªã tr√™n m·ªôt d√≤ng ri√™ng */
            width: 100%; /* Chi·∫øm to√†n b·ªô chi·ªÅu r·ªông c√≥ s·∫µn */
            padding: 10px 12px; /* TƒÉng padding */
            margin-bottom: 10px; /* Kho·∫£ng c√°ch d∆∞·ªõi */
            font-size: 1rem;
            background-color: var(--input-bg);
            color: var(--input-text);
            border: 1px solid var(--input-border);
            border-radius: 6px; /* Bo g√≥c nhi·ªÅu h∆°n */
            box-sizing: border-box; /* Quan tr·ªçng ƒë·ªÉ padding kh√¥ng l√†m tƒÉng k√≠ch th∆∞·ªõc */
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        input[type="text"]:focus, select:focus {
            border-color: var(--input-focus-border);
            outline: 0;
            box-shadow: var(--input-focus-shadow);
        }

        select {
            cursor: pointer;
        }

        /* --- Buttons --- */
        button {
            padding: 10px 18px; /* TƒÉng padding */
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--button-text); /* S·∫Ω b·ªã ghi ƒë√® b·ªüi class c·ª• th·ªÉ */
            background-color: var(--secondary-btn-bg); /* M√†u m·∫∑c ƒë·ªãnh */
            border: none;
            border-radius: 6px; /* ƒê·ªìng b·ªô bo g√≥c */
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            margin-right: 5px; /* Kho·∫£ng c√°ch nh·ªè gi·ªØa c√°c n√∫t */
            margin-bottom: 5px; /* Kho·∫£ng c√°ch khi n√∫t xu·ªëng d√≤ng */
        }

        button:hover {
            background-color: var(--secondary-btn-hover-bg); /* Hover m·∫∑c ƒë·ªãnh */
            /* transform: translateY(-1px); /* Hi·ªáu ·ª©ng nh·∫•c l√™n nh·∫π */
        }

        button:active {
            transform: scale(0.98); /* Hi·ªáu ·ª©ng nh·∫•n xu·ªëng */
        }

        /* Button Specific Colors */
        .group-management button:first-of-type, /* N√∫t T·∫°o nh√≥m */
        .add-card button, /* N√∫t Th√™m th·∫ª */
        #quiz-check-btn { /* N√∫t Ki·ªÉm tra/Ti·∫øp theo/Th·ª≠ l·∫°i */
            background-color: var(--primary-btn-bg);
            color: var(--primary-btn-text);
        }
        .group-management button:first-of-type:hover,
        .add-card button:hover,
        #quiz-check-btn:hover {
            background-color: var(--primary-btn-hover-bg);
        }

        .delete-group-btn,
        .flashcard button { /* N√∫t x√≥a th·∫ª */
            background-color: var(--danger-btn-bg);
            color: var(--danger-btn-text);
            padding: 6px 12px; /* N√∫t x√≥a nh·ªè h∆°n */
            font-size: 0.85rem;
        }
        .delete-group-btn:hover,
        .flashcard button:hover {
            background-color: var(--danger-btn-hover-bg);
        }

        .pause-button {
            background-color: var(--warning-btn-bg);
            color: var(--warning-btn-text);
        }
        .pause-button:hover {
            background-color: var(--warning-btn-hover-bg);
        }

        .resume-button,
        #start-quiz-btn { /* N√∫t B·∫Øt ƒë·∫ßu/Ti·∫øp t·ª•c Quiz */
            background-color: var(--success-btn-bg);
            color: var(--success-btn-text);
        }
        .resume-button:hover,
        #start-quiz-btn:hover {
            background-color: var(--success-btn-hover-bg);
        }

        /* --- Layout Sections --- */
        .group-management {
            margin-bottom: 30px; /* TƒÉng kho·∫£ng c√°ch */
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--card-bg); /* N·ªÅn nh·∫π */
            box-shadow: var(--shadow-sm);
            display: flex;
            flex-wrap: wrap; /* Cho ph√©p xu·ªëng d√≤ng */
            gap: 10px; /* Kho·∫£ng c√°ch gi·ªØa c√°c item */
            align-items: center; /* CƒÉn gi·ªØa c√°c item */
        }
        /* ƒêi·ªÅu ch·ªânh input v√† select trong group management */
        .group-management input[type="text"],
        .group-management select {
            flex: 1 1 180px; /* Cho ph√©p co gi√£n, c∆° s·ªü 180px */
            margin-bottom: 0; /* B·ªè margin bottom v√¨ ƒë√£ c√≥ gap */
            width: auto; /* ƒê·ªÉ flex qu·∫£n l√Ω */
        }
        .group-management button {
            flex-shrink: 0; /* Kh√¥ng co l·∫°i */
            margin-bottom: 0;
        }

        .add-card {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--card-bg);
            box-shadow: var(--shadow-sm);
        }
        .add-card input[type="text"] {
            margin-bottom: 15px; /* Kho·∫£ng c√°ch gi·ªØa 2 input */
        }
        .add-card button {
            width: 100%; /* N√∫t th√™m th·∫ª chi·∫øm h·∫øt chi·ªÅu r·ªông */
        }

        #quiz-controls {
            text-align: center; /* CƒÉn gi·ªØa n√∫t Start/Resume */
            margin-bottom: 20px;
        }
        #quiz-controls button {
            padding: 12px 25px; /* N√∫t to h∆°n */
            font-size: 1.1rem;
        }

        /* --- Flashcard Styling --- */
        #flashcards {
            margin-top: 20px;
        }

        .flashcard {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 15px 20px; /* TƒÉng padding */
            margin-bottom: 15px; /* Kho·∫£ng c√°ch gi·ªØa c√°c th·∫ª */
            border-radius: 8px; /* ƒê·ªìng b·ªô bo g√≥c */
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.2s ease, transform 0.2s ease;
            word-wrap: break-word;
            position: relative; /* ƒê·ªÉ ƒë·ªãnh v·ªã n√∫t x√≥a */
        }

        .flashcard:hover {
            box-shadow: var(--shadow-md);
            /* transform: translateY(-2px); */ /* Hi·ªáu ·ª©ng n·ªïi l√™n nh·∫π khi hover */
        }

        .flashcard strong {
            margin-right: 5px;
            color: var(--text-color);
        }

        .flashcard input[type="text"] {
            width: calc(100% - 30px); /* Tr·ª´ ƒëi padding c·ªßa th·∫ª */
            margin: 5px 0 10px 0; /* Kho·∫£ng c√°ch tr√™n d∆∞·ªõi */
            padding: 6px 8px; /* Padding nh·ªè h∆°n cho input trong th·∫ª */
            font-size: 0.95rem;
            background-color: var(--input-bg); /* ƒê·∫£m b·∫£o n·ªÅn input ƒë√∫ng */
            color: var(--input-text);
            border: 1px solid var(--input-border);
            border-radius: 4px;
        }
        .flashcard input[type="text"]:focus {
            box-shadow: none; /* B·ªè shadow khi focus input trong th·∫ª */
            border-color: var(--input-focus-border);
        }

        .flashcard .answer-display {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed var(--border-color); /* Ph√¢n c√°ch c√¢u tr·∫£ l·ªùi */
        }

        .flashcard button { /* N√∫t x√≥a th·∫ª */
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: 0.7; /* H∆°i m·ªù ƒëi */
            transition: opacity 0.2s ease;
        }
        .flashcard:hover button {
            opacity: 1; /* Hi·ªán r√µ khi hover th·∫ª */
        }

        .hidden {
            display: none !important; /* D√πng !important ƒë·ªÉ ƒë·∫£m b·∫£o ghi ƒë√® */
        }

        /* --- Quiz Container --- */
        #quiz-container {
            margin-top: 30px;
            padding: 25px; /* TƒÉng padding */
            background: var(--card-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-md); /* Shadow r√µ h∆°n cho quiz */
        }

        #quiz-question {
            font-size: 1.3rem; /* C√¢u h·ªèi to h∆°n */
            font-weight: 500;
            margin-bottom: 20px;
        }

        #quiz-answer {
            width: calc(100% - 24px); /* Chi·∫øm g·∫ßn h·∫øt chi·ªÅu r·ªông */
            padding: 10px 12px;
            margin: 15px 0;
            background-color: var(--input-bg);
            color: var(--input-text);
            border: 1px solid var(--input-border);
            border-radius: 6px;
            font-size: 1rem;
        }
        #quiz-answer:focus {
            border-color: var(--input-focus-border);
            outline: 0;
            box-shadow: var(--input-focus-shadow);
        }

        #quiz-feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            min-height: 50px; /* Chi·ªÅu cao t·ªëi thi·ªÉu ƒë·ªÉ tr√°nh nh·∫£y layout */
            transition: background-color 0.3s ease; /* Transition cho feedback */
        }

        #quiz-score {
            margin-top: 15px;
            font-weight: bold;
            text-align: right;
        }

        /* Quiz Feedback Colors */
        .correct {
            color: var(--success-btn-bg); /* M√†u xanh l√° */
            font-weight: bold;
        }

        .wrong {
            color: var(--danger-btn-bg); /* M√†u ƒë·ªè */
            font-weight: bold;
        }
        #quiz-feedback .wrong + div { /* C√°c d√≤ng d∆∞·ªõi ch·ªØ "Sai r·ªìi" */
            margin-top: 8px;
            font-size: 0.95rem;
        }
        #quiz-feedback .wrong + div span[style*="color: red"] { /* T·ª´ ƒë√∫ng m√†u ƒë·ªè */
            background-color: rgba(220, 53, 69, 0.1); /* N·ªÅn ƒë·ªè nh·∫°t */
            padding: 1px 3px;
            border-radius: 3px;
        }
        #quiz-feedback .wrong + div s[style*="color: grey"] { /* T·ª´ sai g·∫°ch ngang */
            opacity: 0.7;
        }


        /* --- Animations (Gi·ªØ nguy√™n ho·∫∑c tinh ch·ªânh n·∫øu c·∫ßn) --- */
        @keyframes correct-pulse {
            0% { transform: scale(1); background-color: rgba(25, 135, 84, 0.1); } /* N·ªÅn xanh nh·∫°t */
            50% { transform: scale(1.02); background-color: rgba(25, 135, 84, 0.2); }
            100% { transform: scale(1); background-color: rgba(25, 135, 84, 0.1); }
        }

        @keyframes wrong-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }

        .animate-correct {
            animation: correct-pulse 0.6s ease-in-out;
            background-color: rgba(25, 135, 84, 0.1); /* N·ªÅn xanh nh·∫°t khi ƒë√∫ng */
        }

        .animate-wrong {
            /* Animation s·∫Ω √°p d·ª•ng cho span .wrong b√™n trong #quiz-feedback */
            animation: wrong-shake 0.5s ease-in-out;
            /* N·ªÅn ƒë·ªè cho to√†n b·ªô feedback khi sai */
            background-color: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        /* Lo·∫°i b·ªè animation c≈© tr√™n #quiz-feedback tr·ª±c ti·∫øp */
        /* #quiz-feedback.animate-wrong { ... } */

        /* √Åp d·ª•ng animation rung l·∫Øc cho span .wrong */
        #quiz-feedback span.wrong.animate-wrong {
            display: inline-block; /* C·∫ßn thi·∫øt ƒë·ªÉ transform ho·∫°t ƒë·ªông */
            animation: wrong-shake 0.5s ease-in-out;
        }

        /* --- Responsive (V√≠ d·ª• ƒë∆°n gi·∫£n) --- */
        @media (max-width: 600px) {
            body {
                padding: 15px;
                margin: 15px auto;
            }
            .group-management {
                flex-direction: column; /* X·∫øp ch·ªìng l√™n nhau tr√™n m√†n h√¨nh nh·ªè */
                align-items: stretch; /* K√©o d√†i c√°c item */
            }
            .group-management input[type="text"],
            .group-management select,
            .group-management button {
                width: 100%; /* Chi·∫øm h·∫øt chi·ªÅu r·ªông */
                margin-right: 0;
            }
            h1 {
                font-size: 1.8rem;
            }
            #quiz-answer {
                width: calc(100% - 20px); /* ƒêi·ªÅu ch·ªânh l·∫°i */
            }
        }

        button.loading {
            position: relative;
            color: transparent !important; /* ·∫®n text g·ªëc */
            pointer-events: none; /* V√¥ hi·ªáu h√≥a click khi ƒëang load */
        }
        
        button.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px; /* K√≠ch th∆∞·ªõc spinner */
            height: 16px;
            margin-top: -8px;
            margin-left: -8px;
            border: 2px solid rgba(255, 255, 255, 0.5); /* M√†u vi·ªÅn spinner */
            border-top-color: #ffffff; /* M√†u ph·∫ßn quay c·ªßa spinner */
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        /* Gi·ªØ l·∫°i animation spin b·∫°n ƒë√£ c√≥ ho·∫∑c d√πng c√°i n√†y */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .folder-item .child-groups {
            display: none; /* ·∫®n nh√≥m con m·∫∑c ƒë·ªãnh */
            margin-left: 20px; /* Th·ª•t l·ªÅ cho nh√≥m con */
            padding-left: 15px;
            border-left: 1px dashed var(--border-color);
        }
        .folder-item.expanded .child-groups {
            display: block; /* Hi·ªán nh√≥m con khi th∆∞ m·ª•c expanded */
        }
        .folder-item > .folder-header { /* Header c·ªßa th∆∞ m·ª•c ƒë·ªÉ click */
            cursor: pointer;
            padding: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .folder-item > .folder-header:hover {
            background-color: rgba(0,0,0,0.05); /* Hi·ªáu ·ª©ng hover nh·∫π */
        }
        .dark-mode .folder-item > .folder-header:hover {
             background-color: rgba(255,255,255,0.1);
        }
        .folder-toggle-icon { /* Icon m≈©i t√™n */
            display: inline-block;
            transition: transform 0.2s ease;
            width: 1em; /* ƒê·∫£m b·∫£o icon chi·∫øm kh√¥ng gian */
            text-align: center;
        }
        .folder-item.expanded .folder-toggle-icon {
            transform: rotate(90deg);
        }
        /* CSS cho group-item gi·ªØ nguy√™n ho·∫∑c ƒëi·ªÅu ch·ªânh n·∫øu c·∫ßn */
        .group-item {
            padding: 8px 5px;
            cursor: pointer;
            border-radius: 4px;
            margin: 3px 0;
        }
        .group-item:hover {
            background-color: rgba(0, 123, 255, 0.1);
        }
         .dark-mode .group-item:hover {
            background-color: rgba(13, 110, 253, 0.2);
        }


        .mindmap-editor-container {
            display: flex; /* Gi·ªØ nguy√™n display: flex */
            flex-direction: column; /* <<< THAY ƒê·ªîI T·ª™ 'row' SANG 'column' */
            gap: 20px; /* Kho·∫£ng c√°ch n√†y gi·ªù s·∫Ω l√† kho·∫£ng c√°ch d·ªçc */
            margin-top: 15px;
            /* align-items: flex-start; */ /* C√≥ th·ªÉ b·ªè ho·∫∑c ƒë·ªïi th√†nh align-items: stretch; n·∫øu mu·ªën c√°c m·ª•c con r·ªông b·∫±ng container */
            align-items: stretch; /* Th·ª≠ stretch ƒë·ªÉ c√°c khu v·ª±c con r·ªông b·∫±ng container */
        }
  
          /* Khu v·ª±c so·∫°n th·∫£o Markdown */
        .markdown-input-area {
            /* flex: 1; */ /* Kh√¥ng c·∫ßn thi·∫øt khi x·∫øp d·ªçc, tr·ª´ khi mu·ªën ki·ªÉm so√°t chi·ªÅu cao */
            width: 100%; /* ƒê·∫£m b·∫£o chi·∫øm ƒë·ªß chi·ªÅu r·ªông */
            display: flex;
            flex-direction: column;
        }
  
          /* Khu v·ª±c hi·ªÉn th·ªã Mindmap SVG */
        .mindmap-display-area {
            /* flex: 1; */ /* Kh√¥ng c·∫ßn thi·∫øt khi x·∫øp d·ªçc, tr·ª´ khi mu·ªën ki·ªÉm so√°t chi·ªÅu cao */
            width: 100%; /* ƒê·∫£m b·∫£o chi·∫øm ƒë·ªß chi·ªÅu r·ªông */
            display: flex;
            flex-direction: column;
        }
  
          /* ƒê·∫£m b·∫£o textarea v√† SVG chi·∫øm h·∫øt kh√¥ng gian c√≤n l·∫°i trong khu v·ª±c c·ªßa ch√∫ng */
        .markdown-input-area textarea {
              /* flex-grow: 1; */ /* V·∫´n gi·ªØ ƒë·ªÉ textarea co gi√£n */
            min-height: 200px; /* C√≥ th·ªÉ ƒë·∫∑t chi·ªÅu cao t·ªëi thi·ªÉu cho textarea */
            resize: vertical;
        }
  
        .mindmap-display-area #mindmap-svg {
              /* flex-grow: 1; */ /* V·∫´n gi·ªØ ƒë·ªÉ SVG co gi√£n */
            width: 100%;
            min-height: 300px; /* Gi·ªØ nguy√™n ho·∫∑c ƒëi·ªÅu ch·ªânh */
              /* border: 1px solid #ccc; */ /* ƒê√£ c√≥ inline style, nh∆∞ng c√≥ th·ªÉ ƒë·∫∑t ·ªü ƒë√¢y */
          }
  
          /* ƒêi·ªÅu ch·ªânh nh·ªè cho c√°c n√∫t v√† text n·∫øu c·∫ßn */
        .markdown-input-area button {
            margin-top: 10px;
        }
        .markdown-input-area p {
            margin-top: 10px;
        }

        .markmap {
            color: var(--markmap-text-color); /* D√≤ng n√†y ph·∫£i t·ªìn t·∫°i */
        }

        body.dark-mode .markmap {
            --markmap-text-color: var(--text-color);
        }
        

    </style>
</head>
<body>
    <!-- Toggle theme switch -->
    <div class="theme-toggle">
        <span>Ch·∫ø ƒë·ªô t·ªëi</span>
        <label class="switch">
            <input type="checkbox" id="theme-switch">
            <span class="slider round">
                <!-- N√∫t tr√≤n di chuy·ªÉn (thay th·∫ø cho :before) -->
                <span class="handle">
                    <span class="icon sun">‚òÄÔ∏è</span>
                    <span class="icon moon">üåô</span>
                </span>
                <!-- C√°c ng√¥i sao v·∫´n n·∫±m trong slider -->
                <span class="stars">
                    <span class="star"></span>
                    <span class="star"></span>
                    <span class="star"></span>
                    <span class="star"></span>
                </span>
            </span>
        </label>
    </div>    
        <main>
            <div id="mindmap-view" class="view hidden">
                <button id="back-to-flashcards-btn">‚¨ÖÔ∏è Quay l·∫°i Flashcards</button>
                <h2 id="mindmap-view-title">Mind Map: T√™n Nh√≥m</h2>

                <div class="mindmap-editor-container">
                    <div class="markdown-input-area">
                        <h3>So·∫°n th·∫£o Markdown</h3>
                        <textarea id="mindmap-markdown-input" rows="15" placeholder="Nh·∫≠p n·ªôi dung mind map b·∫±ng Markdown ·ªü ƒë√¢y..."></textarea>
                        <button id="save-mindmap-btn">üíæ L∆∞u Mind Map</button>
                        <p><small><i>Tip: D√πng d·∫•u # cho ti√™u ƒë·ªÅ ch√≠nh, - ho·∫∑c * cho c√°c nh√°nh. Th·ª•t l·ªÅ ƒë·ªÉ t·∫°o nh√°nh con.</i></small></p>
                    </div>
                    <div class="mindmap-display-area">
                        <h3>Xem tr∆∞·ªõc Mind Map</h3>
                        <svg id="mindmap-svg" style="width: 100%; height: 400px; border: 1px solid #ccc;"></svg>
                    </div>
                </div>
            </div>

            <!-- KHUNG NH√åN 1: Qu·∫£n l√Ω Nh√≥m/Th∆∞ m·ª•c (Hi·ªÉn th·ªã ban ƒë·∫ßu) -->
            <div id="hierarchy-view" class="view">
                <h2>Th∆∞ m·ª•c v√† Nh√≥m b√†i h·ªçc</h2>
                <div id="hierarchy-container">
                    <!-- C·∫•u tr√∫c c√¢y s·∫Ω ƒë∆∞·ª£c render v√†o ƒë√¢y b·∫±ng JavaScript -->
                </div>
    
                <div class="group-management-controls">
                    <h3>Qu·∫£n l√Ω M·ª•c</h3>
                    <input type="text" id="new-item-name" placeholder="T√™n th∆∞ m·ª•c/nh√≥m m·ªõi">
                    <select id="new-item-type">
                        <option value="folder">T·∫°o Th∆∞ m·ª•c</option>
                        <option value="group">T·∫°o Nh√≥m b√†i h·ªçc</option>
                    </select>
                    <select id="parent-folder-select" style="display: none;">
                        <option value="">-- Ch·ªçn th∆∞ m·ª•c cha --</option>
                    </select>
                    <!-- V√≠ d·ª• n√∫t ƒë√∫ng -->
                    <button id="add-item-btn">T·∫°o m·ªõi</button>
                    <hr>
                    <input type="text" id="rename-item" placeholder="T√™n m·ªõi cho m·ª•c ƒë√£ ch·ªçn">
                    <button onclick="renameCurrentItem()">ƒê·ªïi t√™n</button>
                    <button onclick="deleteCurrentItem()" class="danger">X√≥a m·ª•c ƒë√£ ch·ªçn</button>
                     <hr>
                     <select id="move-target-folder-select" disabled>
                         <option value="">-- Di chuy·ªÉn ƒë·∫øn th∆∞ m·ª•c --</option>
                         <option value="root">-- Di chuy·ªÉn ra ngo√†i --</option>
                     </select>
                     <button id="move-item-btn" onclick="moveCurrentItem()" disabled>Di chuy·ªÉn</button>
                </div>
            </div>            
    
            <!-- KHUNG NH√åN 2: Flashcards v√† Quiz (·∫®n ban ƒë·∫ßu) -->
            <div id="flashcard-view" class="hidden">
                <button id="back-to-groups-btn" onclick="showGroupManagementView()">‚¨ÖÔ∏è Quay l·∫°i danh s√°ch</button>
                <h2 id="flashcard-view-title">Flashcards</h2> <!-- Ti√™u ƒë·ªÅ ƒë·ªông -->
    
                <!-- Khu v·ª±c th√™m th·∫ª -->
                <div class="add-card">
                    <h3>Th√™m th·∫ª m·ªõi</h3>
                    <input type="text" id="question" placeholder="C√¢u h·ªèi (M·∫∑t tr∆∞·ªõc)">
                    <input type="text" id="answer" placeholder="C√¢u tr·∫£ l·ªùi (M·∫∑t sau)">
                    <button onclick="addCard()">Th√™m th·∫ª</button>
                </div>
    
                <!-- Khu v·ª±c hi·ªÉn th·ªã flashcards -->
                <div id="flashcards">
                    <!-- Flashcards s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                </div>
    
                <!-- Khu v·ª±c ƒëi·ªÅu khi·ªÉn Quiz -->
                <div id="quiz-controls">
                    <button id="start-quiz-btn" onclick="startQuiz()">B·∫Øt ƒë·∫ßu Quiz</button>
                    <!-- N√∫t Resume s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·∫±ng JS n·∫øu c·∫ßn -->
                </div>
    
                <!-- Khu v·ª±c Quiz (·∫®n ban ƒë·∫ßu trong view n√†y) -->
                <div id="quiz-container" class="hidden">
                     <h3>Quiz Time!</h3>
                     <div id="quiz-score"></div>
                     <div id="quiz-question"></div>
                     <input type="text" id="quiz-answer" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n">
                     <button id="quiz-check-btn" onclick="checkAnswer()">Ki·ªÉm tra</button>
                     <button id="quiz-pause-btn" onclick="pauseQuiz()">T·∫°m d·ª´ng Quiz</button>
                     <div id="quiz-feedback"></div>
                </div>
            </div>
        </main>
        
        <select id="group-select">
            <!-- C√°c th·∫ª <option> s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·ªüi JavaScript -->
        </select>



    <script src="https://cdn.jsdelivr.net/npm/d3@6"></script> <!-- Markmap c·∫ßn D3 -->
    <script src="https://cdn.jsdelivr.net/npm/markmap-lib"></script> <!-- ƒê·ªãnh nghƒ©a markmapLib -->
    <script src="https://cdn.jsdelivr.net/npm/markmap-view"></script> <!-- ƒê·ªãnh nghƒ©a markmap -->

        <!-- C√°c file Script gi·ªØ nguy√™n ·ªü cu·ªëi body -->
        <script src="db.js"></script>
        <script src="ui.js"></script>
        <script src="app.js"></script>    
</body>
</html>

<!-- 
.\venv\Scripts\activate 
=======
<!DOCTYPE html>
<html>
<head>
    <title>Flashcard C√° Nh√¢n</title>
    <style>
        /* --- Base Styles & Variables --- */
        :root {
            --bg-color: #f8f9fa; /* N·ªÅn s√°ng h∆°n m·ªôt ch√∫t */
            --text-color: #212529; /* Text t·ªëi h∆°n m·ªôt ch√∫t */
            --card-bg: #ffffff;
            --border-color: #dee2e6; /* Border nh·∫°t h∆°n */
            --input-bg: #ffffff;
            --input-text: #495057;
            --input-border: #ced4da;
            --input-focus-border: #86b7fe;
            --input-focus-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);

            --primary-btn-bg: #0d6efd;
            --primary-btn-hover-bg: #0b5ed7;
            --primary-btn-text: #ffffff;

            --secondary-btn-bg: #6c757d;
            --secondary-btn-hover-bg: #5c636a;
            --secondary-btn-text: #ffffff;

            --danger-btn-bg: #dc3545;
            --danger-btn-hover-bg: #bb2d3b;
            --danger-btn-text: #ffffff;

            --warning-btn-bg: #ffc107;
            --warning-btn-hover-bg: #ffca2c;
            --warning-btn-text: #000;

            --success-btn-bg: #198754;
            --success-btn-hover-bg: #157347;
            --success-btn-text: #ffffff;

            --shadow-sm: 0 .125rem .25rem rgba(0, 0, 0, .075);
            --shadow-md: 0 .5rem 1rem rgba(0, 0, 0, .15);

            --moon-color: #ffffff; /* Th√™m bi·∫øn m√†u m·∫∑t trƒÉng */
            --handle-dark-bg: transparent; /* N·ªÅn handle trong dark mode */
            --star-size-light: 2px;
            --star-size-dark: 4px; /* K√≠ch th∆∞·ªõc sao l·ªõn h∆°n trong dark mode */
            --star-shadow-dark: 0 0 5px rgba(255, 255, 255, 0.7); /* Shadow sao r√µ h∆°n */
        }

        .dark-mode {
            --bg-color: #212529;
            --text-color: #dee2e6;
            --card-bg: #343a40;
            --border-color: #495057;
            --input-bg: #343a40;
            --input-text: #dee2e6;
            --input-border: #6c757d;
            --input-focus-border: #5b99e4;
            --input-focus-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.35);

            --primary-btn-bg: #0d6efd;
            --primary-btn-hover-bg: #3b82f6;
            --secondary-btn-bg: #6c757d;
            --secondary-btn-hover-bg: #858c93;
            --danger-btn-bg: #dc3545;
            --danger-btn-hover-bg: #e45d6a;
            --warning-btn-bg: #ffc107;
            --warning-btn-hover-bg: #ffd041;
            --success-btn-bg: #198754;
            --success-btn-hover-bg: #20a768;
            --markmap-text-color: var(--text-color);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            max-width: 700px; /* TƒÉng chi·ªÅu r·ªông t·ªëi ƒëa m·ªôt ch√∫t */
            margin: 30px auto; /* TƒÉng margin tr√™n d∆∞·ªõi */
            padding: 20px; /* TƒÉng padding */
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            line-height: 1.6; /* C·∫£i thi·ªán kh·∫£ nƒÉng ƒë·ªçc */
        }

        h1 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--text-color);
        }

        /* --- Theme Toggle Switch --- */
        .theme-toggle {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 25px;
            gap: 10px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #87CEEB; /* M√†u tr·ªùi xanh ban ng√†y */
            transition: background-color .4s;
            overflow: hidden;
            background-color: #FFD700; /* M√†u v√†ng m·∫∑t tr·ªùi (light) */
        }

        /* Style cho n√∫t tr√≤n di chuy·ªÉn m·ªõi (.handle) */
        .slider .handle {
            position: absolute;
            content: "";
            height: 22px; /* K√≠ch th∆∞·ªõc n√∫t tr√≤n */
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: #FFD700; /* M√†u v√†ng m·∫∑t tr·ªùi (light) */
            box-shadow: 0 0 5px rgba(255, 215, 0, 0.7); /* H√†o quang nh·∫π */
            transition: transform .4s, background-color .4s, box-shadow .4s;
            border-radius: 50%; /* Bo tr√≤n n√∫t */
            z-index: 2; /* ƒê·∫£m b·∫£o handle tr√™n stars */
            display: flex; /* ƒê·ªÉ cƒÉn gi·ªØa icon b√™n trong */
            justify-content: center; /* CƒÉn ngang icon */
            align-items: center; /* CƒÉn d·ªçc icon */
            overflow: hidden; /* ·∫®n ph·∫ßn icon th·ª´a n·∫øu c·∫ßn */
            background-color: #FFD700; /* M√†u v√†ng m·∫∑t tr·ªùi (light) */
        }


        input:checked + .slider {
            background-color: #2c3e50; /* M√†u n·ªÅn tr·ªùi ƒë√™m */
        }

        /* Di chuy·ªÉn .handle khi checked */
        input:checked + .slider .handle {
            transform: translateX(30px); /* Kho·∫£ng c√°ch di chuy·ªÉn n√∫t tr√≤n */
            background-color: #f1c40f; /* M√†u v√†ng nh·∫°t h∆°n cho m·∫∑t trƒÉng (dark) */
            box-shadow: none; /* ·∫®n shadow */
        }

        /* Bo tr√≤n slider ngo√†i */
        .slider.round {
            border-radius: 30px;
        }

        /* --- Icons (B√™n trong .handle) --- */
        .handle .icon {
            position: absolute; /* V·∫´n l√† absolute ƒë·ªÉ c√≥ th·ªÉ ch·ªìng l√™n nhau */
            font-size: 16px;
            transition: opacity 0.4s ease; /* Ch·ªâ c·∫ßn transition opacity */
        }

        .handle .sun {
            opacity: 1; /* Hi·ªán ·ªü ch·∫ø ƒë·ªô s√°ng (m·∫∑c ƒë·ªãnh) */
            color: #f39c12;
            animation: spin 10s linear infinite; /* Gi·ªØ animation quay */
        }

        .handle .moon {
            opacity: 0;
            color: var(--moon-color);
        }

        /* Khi switch ƒë∆∞·ª£c check (dark mode) */
        input:checked + .slider .handle .sun {
            opacity: 0; /* ·∫®n m·∫∑t tr·ªùi */
            animation-play-state: paused; /* D·ª´ng quay m·∫∑t tr·ªùi */
        }

        input:checked + .slider .handle .moon {
            opacity: 1; /* Hi·ªán m·∫∑t trƒÉng */
        }

        /* --- Stars (Kh√¥ng ƒë·ªïi) --- */
        .slider .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.4s ease 0.2s;
            pointer-events: none;
            z-index: 0; /* N·∫±m d∆∞·ªõi c√πng */
        }

        .slider .star {
            position: absolute;
            width: var(--star-size-light); /* K√≠ch th∆∞·ªõc sao m·∫∑c ƒë·ªãnh (light) */
            height: var(--star-size-light);
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 0 3px white;
            animation: twinkle 1.5s infinite alternate ease-in-out;
            transition: width 0.4s ease, height 0.4s ease, box-shadow 0.4s ease; /* Th√™m transition */
        }
        .slider .star:nth-child(1) { top: 20%; left: 60%; animation-delay: 0.1s; }
        .slider .star:nth-child(2) { top: 40%; left: 80%; animation-delay: 0.5s; }
        .slider .star:nth-child(3) { top: 70%; left: 75%; animation-delay: 0.9s; }
        .slider .star:nth-child(4) { top: 50%; left: 90%; animation-delay: 0.3s; }

        input:checked + .slider .stars {
            width: var(--star-size-dark);
            height: var(--star-size-dark);
            box-shadow: var(--star-shadow-dark);
        }

        input:checked + .slider .stars {
            opacity: 1;
        }


        /* Keyframes cho animation (Kh√¥ng ƒë·ªïi) */
        @keyframes twinkle {
            from { opacity: 0.2; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        /* S·ª≠a l·∫°i keyframes spin cho ph√π h·ª£p khi icon kh√¥ng c·∫ßn translateY */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        /* --- End Theme Toggle Switch --- */



        /* Rounded sliders */
        .slider.round {
            border-radius: 26px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        /* --- Input Fields & Select --- */
        input[type="text"], select {
            display: block; /* Hi·ªÉn th·ªã tr√™n m·ªôt d√≤ng ri√™ng */
            width: 100%; /* Chi·∫øm to√†n b·ªô chi·ªÅu r·ªông c√≥ s·∫µn */
            padding: 10px 12px; /* TƒÉng padding */
            margin-bottom: 10px; /* Kho·∫£ng c√°ch d∆∞·ªõi */
            font-size: 1rem;
            background-color: var(--input-bg);
            color: var(--input-text);
            border: 1px solid var(--input-border);
            border-radius: 6px; /* Bo g√≥c nhi·ªÅu h∆°n */
            box-sizing: border-box; /* Quan tr·ªçng ƒë·ªÉ padding kh√¥ng l√†m tƒÉng k√≠ch th∆∞·ªõc */
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        input[type="text"]:focus, select:focus {
            border-color: var(--input-focus-border);
            outline: 0;
            box-shadow: var(--input-focus-shadow);
        }

        select {
            cursor: pointer;
        }

        /* --- Buttons --- */
        button {
            padding: 10px 18px; /* TƒÉng padding */
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--button-text); /* S·∫Ω b·ªã ghi ƒë√® b·ªüi class c·ª• th·ªÉ */
            background-color: var(--secondary-btn-bg); /* M√†u m·∫∑c ƒë·ªãnh */
            border: none;
            border-radius: 6px; /* ƒê·ªìng b·ªô bo g√≥c */
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            margin-right: 5px; /* Kho·∫£ng c√°ch nh·ªè gi·ªØa c√°c n√∫t */
            margin-bottom: 5px; /* Kho·∫£ng c√°ch khi n√∫t xu·ªëng d√≤ng */
        }

        button:hover {
            background-color: var(--secondary-btn-hover-bg); /* Hover m·∫∑c ƒë·ªãnh */
            /* transform: translateY(-1px); /* Hi·ªáu ·ª©ng nh·∫•c l√™n nh·∫π */
        }

        button:active {
            transform: scale(0.98); /* Hi·ªáu ·ª©ng nh·∫•n xu·ªëng */
        }

        /* Button Specific Colors */
        .group-management button:first-of-type, /* N√∫t T·∫°o nh√≥m */
        .add-card button, /* N√∫t Th√™m th·∫ª */
        #quiz-check-btn { /* N√∫t Ki·ªÉm tra/Ti·∫øp theo/Th·ª≠ l·∫°i */
            background-color: var(--primary-btn-bg);
            color: var(--primary-btn-text);
        }
        .group-management button:first-of-type:hover,
        .add-card button:hover,
        #quiz-check-btn:hover {
            background-color: var(--primary-btn-hover-bg);
        }

        .delete-group-btn,
        .flashcard button { /* N√∫t x√≥a th·∫ª */
            background-color: var(--danger-btn-bg);
            color: var(--danger-btn-text);
            padding: 6px 12px; /* N√∫t x√≥a nh·ªè h∆°n */
            font-size: 0.85rem;
        }
        .delete-group-btn:hover,
        .flashcard button:hover {
            background-color: var(--danger-btn-hover-bg);
        }

        .pause-button {
            background-color: var(--warning-btn-bg);
            color: var(--warning-btn-text);
        }
        .pause-button:hover {
            background-color: var(--warning-btn-hover-bg);
        }

        .resume-button,
        #start-quiz-btn { /* N√∫t B·∫Øt ƒë·∫ßu/Ti·∫øp t·ª•c Quiz */
            background-color: var(--success-btn-bg);
            color: var(--success-btn-text);
        }
        .resume-button:hover,
        #start-quiz-btn:hover {
            background-color: var(--success-btn-hover-bg);
        }

        /* --- Layout Sections --- */
        .group-management {
            margin-bottom: 30px; /* TƒÉng kho·∫£ng c√°ch */
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--card-bg); /* N·ªÅn nh·∫π */
            box-shadow: var(--shadow-sm);
            display: flex;
            flex-wrap: wrap; /* Cho ph√©p xu·ªëng d√≤ng */
            gap: 10px; /* Kho·∫£ng c√°ch gi·ªØa c√°c item */
            align-items: center; /* CƒÉn gi·ªØa c√°c item */
        }
        /* ƒêi·ªÅu ch·ªânh input v√† select trong group management */
        .group-management input[type="text"],
        .group-management select {
            flex: 1 1 180px; /* Cho ph√©p co gi√£n, c∆° s·ªü 180px */
            margin-bottom: 0; /* B·ªè margin bottom v√¨ ƒë√£ c√≥ gap */
            width: auto; /* ƒê·ªÉ flex qu·∫£n l√Ω */
        }
        .group-management button {
            flex-shrink: 0; /* Kh√¥ng co l·∫°i */
            margin-bottom: 0;
        }

        .add-card {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--card-bg);
            box-shadow: var(--shadow-sm);
        }
        .add-card input[type="text"] {
            margin-bottom: 15px; /* Kho·∫£ng c√°ch gi·ªØa 2 input */
        }
        .add-card button {
            width: 100%; /* N√∫t th√™m th·∫ª chi·∫øm h·∫øt chi·ªÅu r·ªông */
        }

        #quiz-controls {
            text-align: center; /* CƒÉn gi·ªØa n√∫t Start/Resume */
            margin-bottom: 20px;
        }
        #quiz-controls button {
            padding: 12px 25px; /* N√∫t to h∆°n */
            font-size: 1.1rem;
        }

        /* --- Flashcard Styling --- */
        #flashcards {
            margin-top: 20px;
        }

        .flashcard {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 15px 20px; /* TƒÉng padding */
            margin-bottom: 15px; /* Kho·∫£ng c√°ch gi·ªØa c√°c th·∫ª */
            border-radius: 8px; /* ƒê·ªìng b·ªô bo g√≥c */
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.2s ease, transform 0.2s ease;
            word-wrap: break-word;
            position: relative; /* ƒê·ªÉ ƒë·ªãnh v·ªã n√∫t x√≥a */
        }

        .flashcard:hover {
            box-shadow: var(--shadow-md);
            /* transform: translateY(-2px); */ /* Hi·ªáu ·ª©ng n·ªïi l√™n nh·∫π khi hover */
        }

        .flashcard strong {
            margin-right: 5px;
            color: var(--text-color);
        }

        .flashcard input[type="text"] {
            width: calc(100% - 30px); /* Tr·ª´ ƒëi padding c·ªßa th·∫ª */
            margin: 5px 0 10px 0; /* Kho·∫£ng c√°ch tr√™n d∆∞·ªõi */
            padding: 6px 8px; /* Padding nh·ªè h∆°n cho input trong th·∫ª */
            font-size: 0.95rem;
            background-color: var(--input-bg); /* ƒê·∫£m b·∫£o n·ªÅn input ƒë√∫ng */
            color: var(--input-text);
            border: 1px solid var(--input-border);
            border-radius: 4px;
        }
        .flashcard input[type="text"]:focus {
            box-shadow: none; /* B·ªè shadow khi focus input trong th·∫ª */
            border-color: var(--input-focus-border);
        }

        .flashcard .answer-display {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed var(--border-color); /* Ph√¢n c√°ch c√¢u tr·∫£ l·ªùi */
        }

        .flashcard button { /* N√∫t x√≥a th·∫ª */
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: 0.7; /* H∆°i m·ªù ƒëi */
            transition: opacity 0.2s ease;
        }
        .flashcard:hover button {
            opacity: 1; /* Hi·ªán r√µ khi hover th·∫ª */
        }

        .hidden {
            display: none !important; /* D√πng !important ƒë·ªÉ ƒë·∫£m b·∫£o ghi ƒë√® */
        }

        /* --- Quiz Container --- */
        #quiz-container {
            margin-top: 30px;
            padding: 25px; /* TƒÉng padding */
            background: var(--card-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-md); /* Shadow r√µ h∆°n cho quiz */
        }

        #quiz-question {
            font-size: 1.3rem; /* C√¢u h·ªèi to h∆°n */
            font-weight: 500;
            margin-bottom: 20px;
        }

        #quiz-answer {
            width: calc(100% - 24px); /* Chi·∫øm g·∫ßn h·∫øt chi·ªÅu r·ªông */
            padding: 10px 12px;
            margin: 15px 0;
            background-color: var(--input-bg);
            color: var(--input-text);
            border: 1px solid var(--input-border);
            border-radius: 6px;
            font-size: 1rem;
        }
        #quiz-answer:focus {
            border-color: var(--input-focus-border);
            outline: 0;
            box-shadow: var(--input-focus-shadow);
        }

        #quiz-feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            min-height: 50px; /* Chi·ªÅu cao t·ªëi thi·ªÉu ƒë·ªÉ tr√°nh nh·∫£y layout */
            transition: background-color 0.3s ease; /* Transition cho feedback */
        }

        #quiz-score {
            margin-top: 15px;
            font-weight: bold;
            text-align: right;
        }

        /* Quiz Feedback Colors */
        .correct {
            color: var(--success-btn-bg); /* M√†u xanh l√° */
            font-weight: bold;
        }

        .wrong {
            color: var(--danger-btn-bg); /* M√†u ƒë·ªè */
            font-weight: bold;
        }
        #quiz-feedback .wrong + div { /* C√°c d√≤ng d∆∞·ªõi ch·ªØ "Sai r·ªìi" */
            margin-top: 8px;
            font-size: 0.95rem;
        }
        #quiz-feedback .wrong + div span[style*="color: red"] { /* T·ª´ ƒë√∫ng m√†u ƒë·ªè */
            background-color: rgba(220, 53, 69, 0.1); /* N·ªÅn ƒë·ªè nh·∫°t */
            padding: 1px 3px;
            border-radius: 3px;
        }
        #quiz-feedback .wrong + div s[style*="color: grey"] { /* T·ª´ sai g·∫°ch ngang */
            opacity: 0.7;
        }


        /* --- Animations (Gi·ªØ nguy√™n ho·∫∑c tinh ch·ªânh n·∫øu c·∫ßn) --- */
        @keyframes correct-pulse {
            0% { transform: scale(1); background-color: rgba(25, 135, 84, 0.1); } /* N·ªÅn xanh nh·∫°t */
            50% { transform: scale(1.02); background-color: rgba(25, 135, 84, 0.2); }
            100% { transform: scale(1); background-color: rgba(25, 135, 84, 0.1); }
        }

        @keyframes wrong-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }

        .animate-correct {
            animation: correct-pulse 0.6s ease-in-out;
            background-color: rgba(25, 135, 84, 0.1); /* N·ªÅn xanh nh·∫°t khi ƒë√∫ng */
        }

        .animate-wrong {
            /* Animation s·∫Ω √°p d·ª•ng cho span .wrong b√™n trong #quiz-feedback */
            animation: wrong-shake 0.5s ease-in-out;
            /* N·ªÅn ƒë·ªè cho to√†n b·ªô feedback khi sai */
            background-color: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        /* Lo·∫°i b·ªè animation c≈© tr√™n #quiz-feedback tr·ª±c ti·∫øp */
        /* #quiz-feedback.animate-wrong { ... } */

        /* √Åp d·ª•ng animation rung l·∫Øc cho span .wrong */
        #quiz-feedback span.wrong.animate-wrong {
            display: inline-block; /* C·∫ßn thi·∫øt ƒë·ªÉ transform ho·∫°t ƒë·ªông */
            animation: wrong-shake 0.5s ease-in-out;
        }

        /* --- Responsive (V√≠ d·ª• ƒë∆°n gi·∫£n) --- */
        @media (max-width: 600px) {
            body {
                padding: 15px;
                margin: 15px auto;
            }
            .group-management {
                flex-direction: column; /* X·∫øp ch·ªìng l√™n nhau tr√™n m√†n h√¨nh nh·ªè */
                align-items: stretch; /* K√©o d√†i c√°c item */
            }
            .group-management input[type="text"],
            .group-management select,
            .group-management button {
                width: 100%; /* Chi·∫øm h·∫øt chi·ªÅu r·ªông */
                margin-right: 0;
            }
            h1 {
                font-size: 1.8rem;
            }
            #quiz-answer {
                width: calc(100% - 20px); /* ƒêi·ªÅu ch·ªânh l·∫°i */
            }
        }

        button.loading {
            position: relative;
            color: transparent !important; /* ·∫®n text g·ªëc */
            pointer-events: none; /* V√¥ hi·ªáu h√≥a click khi ƒëang load */
        }
        
        button.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px; /* K√≠ch th∆∞·ªõc spinner */
            height: 16px;
            margin-top: -8px;
            margin-left: -8px;
            border: 2px solid rgba(255, 255, 255, 0.5); /* M√†u vi·ªÅn spinner */
            border-top-color: #ffffff; /* M√†u ph·∫ßn quay c·ªßa spinner */
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        /* Gi·ªØ l·∫°i animation spin b·∫°n ƒë√£ c√≥ ho·∫∑c d√πng c√°i n√†y */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .folder-item .child-groups {
            display: none; /* ·∫®n nh√≥m con m·∫∑c ƒë·ªãnh */
            margin-left: 20px; /* Th·ª•t l·ªÅ cho nh√≥m con */
            padding-left: 15px;
            border-left: 1px dashed var(--border-color);
        }
        .folder-item.expanded .child-groups {
            display: block; /* Hi·ªán nh√≥m con khi th∆∞ m·ª•c expanded */
        }
        .folder-item > .folder-header { /* Header c·ªßa th∆∞ m·ª•c ƒë·ªÉ click */
            cursor: pointer;
            padding: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .folder-item > .folder-header:hover {
            background-color: rgba(0,0,0,0.05); /* Hi·ªáu ·ª©ng hover nh·∫π */
        }
        .dark-mode .folder-item > .folder-header:hover {
             background-color: rgba(255,255,255,0.1);
        }
        .folder-toggle-icon { /* Icon m≈©i t√™n */
            display: inline-block;
            transition: transform 0.2s ease;
            width: 1em; /* ƒê·∫£m b·∫£o icon chi·∫øm kh√¥ng gian */
            text-align: center;
        }
        .folder-item.expanded .folder-toggle-icon {
            transform: rotate(90deg);
        }
        /* CSS cho group-item gi·ªØ nguy√™n ho·∫∑c ƒëi·ªÅu ch·ªânh n·∫øu c·∫ßn */
        .group-item {
            padding: 8px 5px;
            cursor: pointer;
            border-radius: 4px;
            margin: 3px 0;
        }
        .group-item:hover {
            background-color: rgba(0, 123, 255, 0.1);
        }
         .dark-mode .group-item:hover {
            background-color: rgba(13, 110, 253, 0.2);
        }


        .mindmap-editor-container {
            display: flex; /* Gi·ªØ nguy√™n display: flex */
            flex-direction: column; /* <<< THAY ƒê·ªîI T·ª™ 'row' SANG 'column' */
            gap: 20px; /* Kho·∫£ng c√°ch n√†y gi·ªù s·∫Ω l√† kho·∫£ng c√°ch d·ªçc */
            margin-top: 15px;
            /* align-items: flex-start; */ /* C√≥ th·ªÉ b·ªè ho·∫∑c ƒë·ªïi th√†nh align-items: stretch; n·∫øu mu·ªën c√°c m·ª•c con r·ªông b·∫±ng container */
            align-items: stretch; /* Th·ª≠ stretch ƒë·ªÉ c√°c khu v·ª±c con r·ªông b·∫±ng container */
        }
  
          /* Khu v·ª±c so·∫°n th·∫£o Markdown */
        .markdown-input-area {
            /* flex: 1; */ /* Kh√¥ng c·∫ßn thi·∫øt khi x·∫øp d·ªçc, tr·ª´ khi mu·ªën ki·ªÉm so√°t chi·ªÅu cao */
            width: 100%; /* ƒê·∫£m b·∫£o chi·∫øm ƒë·ªß chi·ªÅu r·ªông */
            display: flex;
            flex-direction: column;
        }
  
          /* Khu v·ª±c hi·ªÉn th·ªã Mindmap SVG */
        .mindmap-display-area {
            /* flex: 1; */ /* Kh√¥ng c·∫ßn thi·∫øt khi x·∫øp d·ªçc, tr·ª´ khi mu·ªën ki·ªÉm so√°t chi·ªÅu cao */
            width: 100%; /* ƒê·∫£m b·∫£o chi·∫øm ƒë·ªß chi·ªÅu r·ªông */
            display: flex;
            flex-direction: column;
        }
  
          /* ƒê·∫£m b·∫£o textarea v√† SVG chi·∫øm h·∫øt kh√¥ng gian c√≤n l·∫°i trong khu v·ª±c c·ªßa ch√∫ng */
        .markdown-input-area textarea {
              /* flex-grow: 1; */ /* V·∫´n gi·ªØ ƒë·ªÉ textarea co gi√£n */
            min-height: 200px; /* C√≥ th·ªÉ ƒë·∫∑t chi·ªÅu cao t·ªëi thi·ªÉu cho textarea */
            resize: vertical;
        }
  
        .mindmap-display-area #mindmap-svg {
              /* flex-grow: 1; */ /* V·∫´n gi·ªØ ƒë·ªÉ SVG co gi√£n */
            width: 100%;
            min-height: 300px; /* Gi·ªØ nguy√™n ho·∫∑c ƒëi·ªÅu ch·ªânh */
              /* border: 1px solid #ccc; */ /* ƒê√£ c√≥ inline style, nh∆∞ng c√≥ th·ªÉ ƒë·∫∑t ·ªü ƒë√¢y */
          }
  
          /* ƒêi·ªÅu ch·ªânh nh·ªè cho c√°c n√∫t v√† text n·∫øu c·∫ßn */
        .markdown-input-area button {
            margin-top: 10px;
        }
        .markdown-input-area p {
            margin-top: 10px;
        }

        .markmap {
            color: var(--markmap-text-color); /* D√≤ng n√†y ph·∫£i t·ªìn t·∫°i */
        }

        body.dark-mode .markmap {
            --markmap-text-color: var(--text-color);
        }
        

    </style>
</head>
<body>
    <!-- Toggle theme switch -->
    <div class="theme-toggle">
        <span>Ch·∫ø ƒë·ªô t·ªëi</span>
        <label class="switch">
            <input type="checkbox" id="theme-switch">
            <span class="slider round">
                <!-- N√∫t tr√≤n di chuy·ªÉn (thay th·∫ø cho :before) -->
                <span class="handle">
                    <span class="icon sun">‚òÄÔ∏è</span>
                    <span class="icon moon">üåô</span>
                </span>
                <!-- C√°c ng√¥i sao v·∫´n n·∫±m trong slider -->
                <span class="stars">
                    <span class="star"></span>
                    <span class="star"></span>
                    <span class="star"></span>
                    <span class="star"></span>
                </span>
            </span>
        </label>
    </div>    
        <main>
            <div id="mindmap-view" class="view hidden">
                <button id="back-to-flashcards-btn">‚¨ÖÔ∏è Quay l·∫°i Flashcards</button>
                <h2 id="mindmap-view-title">Mind Map: T√™n Nh√≥m</h2>

                <div class="mindmap-editor-container">
                    <div class="markdown-input-area">
                        <h3>So·∫°n th·∫£o Markdown</h3>
                        <textarea id="mindmap-markdown-input" rows="15" placeholder="Nh·∫≠p n·ªôi dung mind map b·∫±ng Markdown ·ªü ƒë√¢y..."></textarea>
                        <button id="save-mindmap-btn">üíæ L∆∞u Mind Map</button>
                        <p><small><i>Tip: D√πng d·∫•u # cho ti√™u ƒë·ªÅ ch√≠nh, - ho·∫∑c * cho c√°c nh√°nh. Th·ª•t l·ªÅ ƒë·ªÉ t·∫°o nh√°nh con.</i></small></p>
                    </div>
                    <div class="mindmap-display-area">
                        <h3>Xem tr∆∞·ªõc Mind Map</h3>
                        <svg id="mindmap-svg" style="width: 100%; height: 400px; border: 1px solid #ccc;"></svg>
                    </div>
                </div>
            </div>

            <!-- KHUNG NH√åN 1: Qu·∫£n l√Ω Nh√≥m/Th∆∞ m·ª•c (Hi·ªÉn th·ªã ban ƒë·∫ßu) -->
            <div id="hierarchy-view" class="view">
                <h2>Th∆∞ m·ª•c v√† Nh√≥m b√†i h·ªçc</h2>
                <div id="hierarchy-container">
                    <!-- C·∫•u tr√∫c c√¢y s·∫Ω ƒë∆∞·ª£c render v√†o ƒë√¢y b·∫±ng JavaScript -->
                </div>
    
                <div class="group-management-controls">
                    <h3>Qu·∫£n l√Ω M·ª•c</h3>
                    <input type="text" id="new-item-name" placeholder="T√™n th∆∞ m·ª•c/nh√≥m m·ªõi">
                    <select id="new-item-type">
                        <option value="folder">T·∫°o Th∆∞ m·ª•c</option>
                        <option value="group">T·∫°o Nh√≥m b√†i h·ªçc</option>
                    </select>
                    <select id="parent-folder-select" style="display: none;">
                        <option value="">-- Ch·ªçn th∆∞ m·ª•c cha --</option>
                    </select>
                    <!-- V√≠ d·ª• n√∫t ƒë√∫ng -->
                    <button id="add-item-btn">T·∫°o m·ªõi</button>
                    <hr>
                    <input type="text" id="rename-item" placeholder="T√™n m·ªõi cho m·ª•c ƒë√£ ch·ªçn">
                    <button onclick="renameCurrentItem()">ƒê·ªïi t√™n</button>
                    <button onclick="deleteCurrentItem()" class="danger">X√≥a m·ª•c ƒë√£ ch·ªçn</button>
                     <hr>
                     <select id="move-target-folder-select" disabled>
                         <option value="">-- Di chuy·ªÉn ƒë·∫øn th∆∞ m·ª•c --</option>
                         <option value="root">-- Di chuy·ªÉn ra ngo√†i --</option>
                     </select>
                     <button id="move-item-btn" onclick="moveCurrentItem()" disabled>Di chuy·ªÉn</button>
                </div>
            </div>            
    
            <!-- KHUNG NH√åN 2: Flashcards v√† Quiz (·∫®n ban ƒë·∫ßu) -->
            <div id="flashcard-view" class="hidden">
                <button id="back-to-groups-btn" onclick="showGroupManagementView()">‚¨ÖÔ∏è Quay l·∫°i danh s√°ch</button>
                <h2 id="flashcard-view-title">Flashcards</h2> <!-- Ti√™u ƒë·ªÅ ƒë·ªông -->
    
                <!-- Khu v·ª±c th√™m th·∫ª -->
                <div class="add-card">
                    <h3>Th√™m th·∫ª m·ªõi</h3>
                    <input type="text" id="question" placeholder="C√¢u h·ªèi (M·∫∑t tr∆∞·ªõc)">
                    <input type="text" id="answer" placeholder="C√¢u tr·∫£ l·ªùi (M·∫∑t sau)">
                    <button onclick="addCard()">Th√™m th·∫ª</button>
                </div>
    
                <!-- Khu v·ª±c hi·ªÉn th·ªã flashcards -->
                <div id="flashcards">
                    <!-- Flashcards s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                </div>
    
                <!-- Khu v·ª±c ƒëi·ªÅu khi·ªÉn Quiz -->
                <div id="quiz-controls">
                    <button id="start-quiz-btn" onclick="startQuiz()">B·∫Øt ƒë·∫ßu Quiz</button>
                    <!-- N√∫t Resume s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·∫±ng JS n·∫øu c·∫ßn -->
                </div>
    
                <!-- Khu v·ª±c Quiz (·∫®n ban ƒë·∫ßu trong view n√†y) -->
                <div id="quiz-container" class="hidden">
                     <h3>Quiz Time!</h3>
                     <div id="quiz-score"></div>
                     <div id="quiz-question"></div>
                     <input type="text" id="quiz-answer" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n">
                     <button id="quiz-check-btn" onclick="checkAnswer()">Ki·ªÉm tra</button>
                     <button id="quiz-pause-btn" onclick="pauseQuiz()">T·∫°m d·ª´ng Quiz</button>
                     <div id="quiz-feedback"></div>
                </div>
            </div>
        </main>
        
        <select id="group-select">
            <!-- C√°c th·∫ª <option> s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·ªüi JavaScript -->
        </select>



    <script src="https://cdn.jsdelivr.net/npm/d3@6"></script> <!-- Markmap c·∫ßn D3 -->
    <script src="https://cdn.jsdelivr.net/npm/markmap-lib"></script> <!-- ƒê·ªãnh nghƒ©a markmapLib -->
    <script src="https://cdn.jsdelivr.net/npm/markmap-view"></script> <!-- ƒê·ªãnh nghƒ©a markmap -->

        <!-- C√°c file Script gi·ªØ nguy√™n ·ªü cu·ªëi body -->
        <script src="db.js"></script>
        <script src="ui.js"></script>
        <script src="app.js"></script>    
</body>
</html>

<!-- 
.\venv\Scripts\activate 
>>>>>>> 51f692d4c1c3251ed714808cee191bfd31ea8c85
--> 